<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="styles.css">
<link rel="icon" type="image/x-icon" href="favicon.png">
</head>
<body>
<div class="container">
<div class="column" id="column1">
<div class="logo">
<img src="biscuit_logo.svg">
<label class="version">master</label>
</div>
<ul id="menu-top-level">
<li id="menu-top-level-item"><a href="index.html">Home</a></li>
<li id="menu-top-level-item"><a href="installation.html">Installation</a></li>
<li id="menu-top-level-item"><a href="manual.html">Manual</a></li>
<li id="menu-top-level-item"><a href="modules.html">Modules</a></li>
<li id="menu-top-level-item"><a href="examples.html">Examples</a></li>
</ul>
</div>
<div class="column" id="column2">
<h1 id="Threading">Threading</h1>
<p>Compile using <code>blc my-file-name.bl</code> and run <code>./out</code>.</p>

<pre><code><span class="syntax-directive">#import</span> "std/thread"
<span class="syntax-directive">#import</span> "std/sync"

mutex: std.Mutex;

main :: <span class="syntax-keyword">fn</span> () s32 <span class="syntax-keyword">{</span>
	print("Start thread!!!\n");
	<span class="syntax-keyword">defer</span> print("Threads joined!!!\n");

	std.mutex_init(&mutex);
	<span class="syntax-keyword">defer</span> std.mutex_terminate(&mutex);

	t1 :: std.thread_create(&first);
	t2 :: std.thread_create(&second);

	std.thread_join(t1);
	std.thread_join(t2);

	<span class="syntax-keyword">return</span> 0;
<span class="syntax-keyword">}</span>

first :: <span class="syntax-keyword">fn</span> (args: *u8) s32 <span class="syntax-keyword">{</span>
	<span class="syntax-keyword">loop</span> i := 0; i &lt; 10; i += 1 <span class="syntax-keyword">{</span>
		std.mutex_lock(&mutex);
		
		print("Hello from first thread!\n");

		std.mutex_unlock(&mutex);
		os_sleep_ms(50);
	<span class="syntax-keyword">}</span>
	<span class="syntax-keyword">return</span> 0;
<span class="syntax-keyword">}</span>

second :: <span class="syntax-keyword">fn</span> (args: *u8) s32 <span class="syntax-keyword">{</span>
	<span class="syntax-keyword">loop</span> i := 0; i &lt; 10; i += 1 <span class="syntax-keyword">{</span>
		std.mutex_lock(&mutex);
		
		print("Hello from second thread!\n");

		std.mutex_unlock(&mutex);
		os_sleep_ms(100);
	<span class="syntax-keyword">}</span>
	<span class="syntax-keyword">return</span> 0;
<span class="syntax-keyword">}</span>

</code></pre>
</div>
<div class="column" id="column3">
<ul id="menu-top-level">
<li id="menu-top-level-item"><a href="#Threading">Threading</a></li>
</ul>
</div>
</div>
</body>
</html>
