<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="stylesheet" href="styles.css">
<link rel="icon" type="image/x-icon" href="favicon.png">
</head>
<body>
<div class="container">
<div class="column" id="column1">
<div class="logo">
<img src="biscuit_logo.svg">
<label class="version">master</label>
</div>
<ul id="menu-top-level">
<li id="menu-top-level-item"><a href="index.html">Home</a></li>
<li id="menu-top-level-item"><a href="installation.html">Installation</a></li>
<li id="menu-top-level-item"><a href="manual.html">Manual</a></li>
<li id="menu-top-level-item"><a href="modules.html">Modules</a></li>
<li id="menu-top-level-item"><a href="examples.html">Examples</a></li>
</ul>
</div>
<div class="column" id="column2">
<h1 id="Pool-Allocator">Pool Allocator</h1>
<p><code>#import "std/pool"</code></p>
<p>Pool allocator is simple growing allocator grouping all allocated memory into memory blocks
of <code>POOL_DEFAULT_SIZE</code> bytes by default.</p>
<h3 id="Supported-Operations">Supported Operations</h3>

<pre><code>- [x] Allocate
- [-] Reallocate (Always allocates and copy data into a new block.)
- [-] Free (Keeps memory for later use.)
- [x] Release
- [x] Reset
</code></pre>
<ul>
<li>In case there is no space left in the current block new one is allocated.</li>
<li>Allocated data remains valid until the <code>reset</code> or <code>release</code> is called.</li>
<li>If required allocation size is greater then the current block size, the new block is allocated
with size <code>N * current_block_size</code> where <code>N</code> is the minimum multiplier needed to store the required
data size.</li>
<li>The pool allocator never frees data when <code>free</code> is called, you should call <code>reset</code> instead
when all previously allocated data can be freed.</li>
<li>All preallocated blocks are kept (even after the <code>reset</code> is called) for later use.</li>
</ul>
<p><span class="hint-note"><b>Note:</b>
This allocator is used as a default temporary allocator in the application context.</span></p>
<h2 id="std.POOL_DEFAULT_SIZE">std.POOL_DEFAULT_SIZE</h2>

<pre><code>POOL_DEFAULT_SIZE : usize : 65536
</code></pre>
<p><em>File: pool.bl</em></p>
<h2 id="std.PoolAllocator">std.PoolAllocator</h2>

<pre><code>PoolAllocator :: <span class="syntax-keyword">struct</span> <span class="syntax-keyword">{</span>
    block_size: usize;
    allocator: *Allocator;
    used_blocks: [..]*u8;
    unused_blocks: [..]*u8;
    obsolete_blocks: [..]*u8;
    current_block: *u8;
    top: *u8;
    space: usize;
<span class="syntax-keyword">}</span>
</code></pre>
<p>Pool allocator type.</p>
<h3 id="Members">Members</h3>
<ul>
<li><code>block_size</code> - Size of the current block.</li>
<li><code>allocator</code> - Base allocator used to allocate block memory.</li>
</ul>
<p><em>File: pool.bl</em></p>
<h2 id="std.pool_default">std.pool_default</h2>

<pre><code>pool_default :: 
</code></pre>
<p>Default pool allocator instance using the current allocator in application context and <code>POOL_DEFAULT_SIZE</code>.</p>
<p><em>File: pool.bl</em></p>
<h2 id="std.pool_make">std.pool_make</h2>

<pre><code>pool_make :: <span class="syntax-keyword">fn</span> (allocator : *Allocator: null, block_size :: POOL_DEFAULT_SIZE) PoolAllocator <span class="syntax-directive">#inline</span>
</code></pre>
<p>Make new pool allocator instance. The <code>allocator</code> is the allocator used internally to allocate
block memory. The <code>block_size</code> is size of each preallocated block in Bytes (note that the block
size can grow over time when bigger continuous memory allocations are required).</p>
<p><em>File: pool.bl</em></p>
<h2 id="std.pool_release">std.pool_release</h2>

<pre><code>pool_release :: <span class="syntax-keyword">fn</span> (pool: *PoolAllocator) 
</code></pre>
<p>Release all allocated memory used by <code>pool</code> (allocated in <code>pool.allocator</code>).</p>
<p><em>File: pool.bl</em></p>
<h2 id="std.pool_reset">std.pool_reset</h2>

<pre><code>pool_reset :: <span class="syntax-keyword">fn</span> (pool: *PoolAllocator)  <span class="syntax-directive">#inline</span>
</code></pre>
<p>Invalidate all allocations but keep preallocated memory block for later use.</p>
<p><em>File: pool.bl</em></p>
</div>
<div class="column" id="column3">
<ul id="menu-top-level">
<li id="menu-top-level-item"><a href="#Pool-Allocator">Pool Allocator</a></li>
<ul>
<li><a href="#std.POOL_DEFAULT_SIZE">std.POOL_DEFAULT_SIZE</a></li>
<li><a href="#std.PoolAllocator">std.PoolAllocator</a></li>
<li><a href="#std.pool_default">std.pool_default</a></li>
<li><a href="#std.pool_make">std.pool_make</a></li>
<li><a href="#std.pool_release">std.pool_release</a></li>
<li><a href="#std.pool_reset">std.pool_reset</a></li>
</ul>
</ul>
</div>
</div>
</body>
</html>
